---
services:
  dockgo:
    build: .
    container_name: dockgo
    # Optional: If using Apprise API container for sending notifications
    # depends_on:
    #   - apprise
    restart: unless-stopped
    ports:
      - "3131:3131"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      # Mount .env if you want to use file-based config, 
      # or you can set environment variables here directly.
      - ./.env:/app/.env
      # Required for persistent session invalidation across restarts
      - ./data:/app/data
    environment:
      - LOG_LEVEL=info # debug, info, warn, error
      - CORS_ORIGIN=http://localhost:3131
      # Option 1: Legacy Token
      # - API_TOKEN=your_secure_token_here
      # Option 2: User Login
      # - AUTH_USERNAME=admin
      # Recommended (Production): Pre-hashed bcrypt string (generate with `dockgo hash-password secret`)
      # Double the '$' character to escape it in docker-compose.yml files (e.g., $$2a$$10$$...)
      # - AUTH_PASSWORD_HASH=$$2a$$10$$w...
      # Convenience (Testing): Plaintext password (not recommended for production)
      # - AUTH_PASSWORD=supersecurepassword
      # - AUTH_SECRET=random_string_for_signing_cookies
      # - AUTH_BCRYPT_COST=10 # Optional: Set hashing complexity (min 4, max 31, default 10)

      # Compose Security
      # Restrict Compose working directories to specific base paths (optional but recommended)
      # Comma-separated list of allowed base paths. If empty, any valid directory is allowed.
      # Example: ALLOWED_COMPOSE_PATHS=/opt/docker,/home/user/docker,/data/compose
      # - ALLOWED_COMPOSE_PATHS=

      # Optional: Apprise API Endpoint for notifications
      # - APPRISE_QUEUE_SIZE=200
      # - APPRISE_URL=gotify://gotify.example.com/myprivatetopic
      # - APPRISE_URL=ntfys://user:pass@ntfy.example.com/myprivatetopic

      # Background Update Polling Schedule for notifications (Default: 24h)
      # Valid units: 's' (seconds), 'm' (minutes), 'h' (hours)
      # Examples: '12h' (12 hours), '30m' (30 minutes)
      # - SCAN_INTERVAL=24h

  # Optional: Apprise API container for sending notifications
  # apprise:
  #   image: caronc/apprise
  #   container_name: apprise
  #   restart: unless-stopped
  #   ports:
  #     - "8000:8000"
